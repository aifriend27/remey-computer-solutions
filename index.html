<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Business Repair Services</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#00aaff" />
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js').then(function(reg) {
          console.log('ServiceWorker registered:', reg);
        }, function(err) {
          console.log('ServiceWorker registration failed:', err);
        });
      });
    }
  </script>
</head>
<body>
  <div class="glass-bg"></div>
  <div class="infinity-rgb">
    <div class="infinity-shape"></div>
    <div class="infinity-shape2"></div>
    <div class="infinity-shape3"></div>
  </div>
  <canvas id="matrixRain" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none;display:none;"></canvas>
  <div class="header">
    <div class="business-name">Business Repair Services</div>
    <div class="social-icons">
      <a href="https://www.tiktok.com/" target="_blank" aria-label="TikTok" class="social-icon tiktok" rel="noopener">
        <svg width="28" height="28" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="24" fill="#000"/><path d="M33.5 20.5c-2.5 0-4.5-2-4.5-4.5V10h-5v18.5c0 1.1-.9 2-2 2s-2-.9-2-2 0-2 0-2h-5s0 2.5 0 4.5c0 4.1 3.4 7.5 7.5 7.5s7.5-3.4 7.5-7.5V25c1.4 1 3.1 1.5 5 1.5v-6z" fill="#fff"/></svg>
      </a>
      <a href="https://www.instagram.com/" target="_blank" aria-label="Instagram" class="social-icon instagram" rel="noopener">
        <svg width="28" height="28" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="24" fill="#fff"/><rect x="14" y="14" width="20" height="20" rx="6" fill="#E1306C"/><circle cx="24" cy="24" r="5" fill="#fff"/><circle cx="31" cy="17" r="2" fill="#fff"/></svg>
      </a>
      <a href="https://www.facebook.com/" target="_blank" aria-label="Facebook" class="social-icon facebook" rel="noopener">
        <svg width="28" height="28" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="24" fill="#1877F3"/><path d="M26.5 34V25.5h2.5l.5-4h-3V19c0-1.1.3-1.8 1.8-1.8H29V14.2C28.7 14.1 27.7 14 26.6 14c-3 0-4.6 1.8-4.6 5.1v2.9H19v4h3v8.5h4.5z" fill="#fff"/></svg>
      </a>
      <a href="https://www.youtube.com/" target="_blank" aria-label="YouTube" class="social-icon youtube" rel="noopener">
        <svg width="28" height="28" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="24" fill="#FF0000"/><polygon points="20,16 34,24 20,32" fill="#fff"/></svg>
      </a>
    </div>
  </div>
  <div style="display: flex; flex-direction: column; align-items: center; flex: none;">
    <section class="hero">
      <div class="hero-content">
        <h1 class="hero-title">REMAY COMPUTER Solutions</h1>
        <p class="hero-subtitle">Expert Repair & Tech Services in Nairobi</p>
        <div class="hero-actions">
          <button class="hero-btn primary" id="videoCallBtn">
            <span id="hudText">Start Video Call</span><span id="typewriterCursor" style="display:none;">|</span>
          </button>
        </div>
      </div>
    </section>
    <!-- Contact & Voicemail Section (Modernized) -->
    <section class="contact-voicemail">
      <div class="contact-voicemail-grid">
        <div class="contact-card">
          <h3>Contact Us</h3>
          <p>Reach out for quick support, questions, or to book a service. We're here to help!</p>
          <div class="contact-options-modern">
            <a href="https://wa.me/254725016032" class="contact-modern-btn whatsapp" target="_blank">WhatsApp</a>
            <a href="tel:+254725016032" class="contact-modern-btn call">Call</a>
            <a href="mailto:remaycomputersolutions@gmail.com" class="contact-modern-btn email">Email</a>
          </div>
        </div>
      </div>
    </section>
  </div>

  <section class="services">
    <h2 class="services-title">Our Services</h2>
    <div class="services-grid">
      <div class="service-card">
        <div class="service-icon">üì±</div>
        <h3>Phone Repair</h3>
        <p>Screen, battery, charging port, camera, software, unlocking, and more. Fast, expert service for all major brands.</p>
        <button class="service-btn" onclick="showHudPopup({title: 'Phone Repair', lines: ['Contact: +254 705 926 066', '', 'Screen replacement', 'Charging port repair', 'Battery replacement', 'Camera repair', 'Software updates', 'Unlocking & flashing']})">Learn More</button>
      </div>
      <div class="service-card">
        <div class="service-icon">üíª</div>
        <h3>Laptop Repair</h3>
        <p>Screen, keyboard, motherboard, OS install, RAM/SSD upgrades, and more. All brands and models supported.</p>
        <button class="service-btn" onclick="showHudPopup({title: 'Laptop Repair', lines: ['Contact: +254 786 102 736', '', 'Screen replacement', 'Keyboard repair', 'Motherboard diagnostics', 'OS installation', 'RAM & SSD upgrades']})">Learn More</button>
      </div>
      <div class="service-card">
        <div class="service-icon">‚åöüîë</div>
        <h3>Key & Watch Repair</h3>
        <p>Key duplication, extraction, watch battery/strap, wall clock repair, and more. Fast and reliable.</p>
        <button class="service-btn" onclick="showHudPopup({title: 'Key & Watch Repair', lines: ['Contact: +254 705 222 640', '', 'Key duplication', 'Broken key extraction', 'Watch battery/strap', 'Wall clock repair']})">Learn More</button>
      </div>
      <div class="service-card">
        <div class="service-icon">üñ®</div>
        <h3>Printer Repair</h3>
        <p>Diagnostics, cartridge/toner, print head cleaning, software, and network setup. All major brands.</p>
        <button class="service-btn" onclick="showHudPopup({title: 'Printer Repair', lines: ['Contact: +254 725 016 032', '', 'Diagnostics', 'Cartridge/toner', 'Print head cleaning', 'Software install', 'Network setup']})">Learn More</button>
      </div>
      <div class="service-card">
        <div class="service-icon">üéßüñ±</div>
        <h3>Accessories</h3>
        <p>Chargers, cables, power banks, cases, bags, headphones, and more. Quality tech accessories for all devices.</p>
        <button class="service-btn" onclick="showHudPopup({title: 'Accessories', lines: ['Chargers', 'Cables', 'Power banks', 'Cases', 'Bags', 'Headphones', 'More...']})">Learn More</button>
      </div>
      <div class="service-card">
        <div class="service-icon">üìç</div>
        <h3>Our Location</h3>
        <p>Tana House Building, 1st Floor, Room 113, Karen Shopping Centre, Nairobi. Visit us today!</p>
        <button class="service-btn" onclick="showHudPopup({title: 'Our Location', lines: ['Tana House Building, 1st Floor, Room 113', 'Karen Shopping Centre', 'Langata Road, Nairobi', 'Postal Code: 00502']})">View Map</button>
      </div>
    </div>
  </section>

  <div id="hudPopupRoot"></div>

  <!-- Contact Selection Modal -->
  <div id="contactSelectModal" class="hud-modal" style="display:none;z-index:1000;">
    <h2 id="contactSelectTitle">Choose Contact</h2>
    <div id="contactSelectList"></div>
    <button onclick="closeContactSelectModal()" class="hud-modal-close">√ó</button>
  </div>

  <!-- Service Details Modal -->
  <div id="serviceDetailsModal" class="hud-modal" style="display:none;z-index:2000;max-width:420px;margin:auto;">
    <div id="serviceDetailsContent"></div>
    <button onclick="closeServiceDetailsModal()" class="hud-modal-close">√ó</button>
  </div>

  <!-- Admin Image Upload Button (always visible for admin/testing) -->
  <button id="adminUploadBtn" style="position:fixed;bottom:24px;right:24px;z-index:3000;background:#00aaff;color:#fff;border:none;border-radius:50%;width:56px;height:56px;font-size:2em;box-shadow:0 2px 8px #0005;cursor:pointer;">+</button>
  <script>
  // --- Make admin upload button always visible ---
  document.getElementById('adminUploadBtn').style.display = 'block';
  </script>

  <!-- Admin Image Upload Modal -->
  <div id="adminUploadModal" class="hud-modal" style="display:none;z-index:4000;max-width:340px;margin:auto;">
    <h2>Admin: Upload Gallery Image</h2>
    <input id="adminImageInput" type="file" accept="image/*" style="margin:16px 0;" />
    <img id="adminImagePreview" src="" style="display:none;max-width:100%;margin-bottom:12px;border-radius:8px;" />
    <button id="adminImageSend" class="hud-modal-btn" style="display:none;">Upload Image</button>
    <button onclick="closeAdminUploadModal()" class="hud-modal-close">√ó</button>
  </div>

  <!-- Public Gallery Section -->
  <section class="gallery-section" id="publicGallery">
    <h2 class="services-title">Gallery</h2>
    <div id="galleryGrid" class="services-grid"></div>
  </section>

  <script>
    // --- Admin Upload Button Logic (Always visible, password required every time) ---
    (function() {
      const adminUploadBtn = document.getElementById('adminUploadBtn');
      const adminUploadModal = document.getElementById('adminUploadModal');
      const adminImageInput = document.getElementById('adminImageInput');
      const adminImagePreview = document.getElementById('adminImagePreview');
      const adminImageSend = document.getElementById('adminImageSend');
      let adminImageFile = null;

      // Always show the button
      adminUploadBtn.style.display = 'block';

      adminUploadBtn.onclick = function() {
        const key = prompt('Admin: Enter gallery upload password');
        if (key === 'REMAY2025') {
          adminUploadModal.style.display = 'block';
          adminImageInput.value = '';
          adminImagePreview.style.display = 'none';
          adminImageSend.style.display = 'none';
        } else if (key !== null) {
          alert('Incorrect password.');
        }
      };
      adminImageInput.onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
          adminImageFile = file;
          const reader = new FileReader();
          reader.onload = function(ev) {
            adminImagePreview.src = ev.target.result;
            adminImagePreview.style.display = 'block';
            adminImageSend.style.display = '';
          };
          reader.readAsDataURL(file);
        }
      };
      adminImageSend.onclick = async function() {
        if (!adminImageFile) return;
        adminImageSend.disabled = true;
        adminImageSend.textContent = 'Uploading...';
        const formData = new FormData();
        formData.append('image', adminImageFile);
        try {
          const response = await fetch('http://localhost:3000/admin-upload-image', {
            method: 'POST',
            body: formData
          });
          if (!response.ok) throw new Error('Upload failed');
          adminImageSend.textContent = 'Uploaded!';
          alert('Image uploaded to gallery!');
          closeAdminUploadModal();
          loadGalleryImages();
        } catch (err) {
          alert('Failed to upload image.');
          adminImageSend.disabled = false;
          adminImageSend.textContent = 'Upload Image';
        }
      };
      window.closeAdminUploadModal = function() {
        adminUploadModal.style.display = 'none';
        adminImagePreview.src = '';
        adminImagePreview.style.display = 'none';
        adminImageSend.style.display = 'none';
        adminImageSend.disabled = false;
        adminImageSend.textContent = 'Upload Image';
        adminImageFile = null;
      };
    })();

    // --- Public Gallery Display Logic ---
    async function loadGalleryImages() {
      try {
        const res = await fetch('http://localhost:3000/gallery-images');
        if (!res.ok) throw new Error('Failed to load gallery');
        const images = await res.json();
        const grid = document.getElementById('galleryGrid');
        grid.innerHTML = '';
        images.forEach(img => {
          const div = document.createElement('div');
          div.className = 'service-card';
          div.innerHTML = `<img src="http://localhost:3000/images/${encodeURIComponent(img)}" alt="Gallery Image" style="width:100%;border-radius:12px;box-shadow:0 2px 8px #0002;max-height:180px;object-fit:cover;" />`;
          grid.appendChild(div);
        });
      } catch (e) {
        document.getElementById('galleryGrid').innerHTML = '<div style="color:#888;">No gallery images yet.</div>';
      }
    }
    loadGalleryImages();

    document.addEventListener('DOMContentLoaded', function() {
      // --- Click Sound Logic ---
      window.playClickSound = window.playClickSound || function() {
        try {
          const audio = new Audio('sounds/click-confirm.mp3.mp3');
          audio.volume = 0.7;
          audio.play();
        } catch (e) { console.error('playClickSound error', e); }
      };
      // Attach click sound to major interactive buttons
      function attachClickSoundToButtons() {
        const selectors = [
          '.contact-modern-btn',
          '.service-btn',
          '.hud-modal-btn',
          '.footer-nav a',
          '.hero-btn',
          '.bottom-button'
        ];
        selectors.forEach(sel => {
          document.querySelectorAll(sel).forEach(btn => {
            if (!btn._clickSoundAttached) {
              btn.addEventListener('click', playClickSound, false);
              btn._clickSoundAttached = true;
            }
          });
        });
      }
      attachClickSoundToButtons();
      // If dynamic buttons are added, re-attach after modals open
      document.addEventListener('DOMNodeInserted', attachClickSoundToButtons);

      // --- Ensure required functions exist ---
      window.playHqRingtone = window.playHqRingtone || function() {
        try {
          if (!window._hqRingtone) {
            window._hqRingtone = new Audio('sounds/calling.wav');
            window._hqRingtone.loop = true;
          }
          window._hqRingtone.currentTime = 0;
          window._hqRingtone.play();
          console.log('Ringtone playing');
        } catch (e) { console.error('playHqRingtone error', e); }
      };
      window.stopHqRingtone = window.stopHqRingtone || function() {
        try {
          if (window._hqRingtone) { window._hqRingtone.pause(); window._hqRingtone.currentTime = 0; }
          console.log('Ringtone stopped');
        } catch (e) { console.error('stopHqRingtone error', e); }
      };
      window.playVideoCallOpeningSound = window.playVideoCallOpeningSound || function() {
        try {
          let audio = new Audio('sounds/scif-fi-Video call opening-mp3.wav');
          audio.play();
          console.log('Video call opening sound played');
        } catch (e) { console.error('playVideoCallOpeningSound error', e); }
      };
      window.closeVideoCall = window.closeVideoCall || function() {
        try {
          const videoCallContainer = document.getElementById('videoCallContainer');
          if (videoCallContainer) videoCallContainer.style.display = 'none';
          const video = document.getElementById('videoFeed');
          if (video) video.srcObject = null;
          document.getElementById('videoCallBtn').style.display = '';
          console.log('Video call closed');
        } catch (e) { console.error('closeVideoCall error', e); }
      };
      window.activateHudMode = window.activateHudMode || function() { console.log('HUD mode activated'); };

      // --- Ensure video call container and video element exist ---
      if (!document.getElementById('videoCallContainer')) {
        const container = document.createElement('div');
        container.id = 'videoCallContainer';
        container.className = 'hud-modal';
        container.style.display = 'none';
        container.innerHTML = '<video id="videoFeed" autoplay playsinline style="width:100%;height:auto;display:none;"></video><button onclick="closeVideoCall()" class="hud-modal-close">√ó</button>';
        document.body.appendChild(container);
        console.log('Injected videoCallContainer into DOM');
      }

      // --- Video Call Button Logic ---
      const videoCallBtn = document.getElementById('videoCallBtn');
      if (videoCallBtn) {
        console.log('Video Call Button handler attached');
        videoCallBtn.onclick = async function() {
          console.log('Video Call Button clicked');
          playHqRingtone();
          let videoStream = null;
          try {
            videoStream = await navigator.mediaDevices.getUserMedia({
              video: { width: { ideal: 800 }, height: { ideal: 320 }, facingMode: 'user' },
              audio: true
            });
            console.log('Camera/mic permission granted, stream ready');
            stopHqRingtone();
            playVideoCallOpeningSound();
            const videoCallContainer = document.getElementById('videoCallContainer');
            videoCallContainer.classList.remove('fade-in');
            void videoCallContainer.offsetWidth;
            videoCallContainer.classList.add('fade-in');
            videoCallBtn.style.display = 'none';
            videoCallContainer.style.display = 'flex';
            const video = document.getElementById('videoFeed');
            video.srcObject = videoStream;
            video.style.display = 'block';
            video.style.transform = 'scaleX(1)'; // Force no mirror, even for front camera
            // --- Add custom HUD frame styling ---
            video.classList.add('hud-video-frame');
            // Optionally, wrap the video in a styled HUD frame container
            let hudFrame = document.getElementById('hudVideoFrameContainer');
            if (!hudFrame) {
              hudFrame = document.createElement('div');
              hudFrame.id = 'hudVideoFrameContainer';
              hudFrame.className = 'hud-frame-container';
              video.parentNode.insertBefore(hudFrame, video);
              hudFrame.appendChild(video);
            }
            await video.play();
            console.log('Video feed started');
          } catch (err) {
            stopHqRingtone();
            alert('Could not access webcam or microphone: ' + err);
            closeVideoCall();
            console.error('getUserMedia error', err);
          }
          activateHudMode();
        };
      } else {
        console.error('Video Call Button not found in DOM');
      }

      // --- Other DOM-dependent logic ---
      const bottomButton = document.querySelector('.bottom-button');
      if (bottomButton) {
        bottomButton.onclick = function() {
          document.getElementById('contactModal').style.display = 'block';
        };
      }
      window.onclick = function(event) {
        var modal = document.getElementById('contactModal');
        if (event.target == modal) {
          modal.style.display = 'none';
        }
      };

      // --- Video Recording Button Logic ---
      const recordVoicemailBtn = document.getElementById('openVoicemailModal');
      const voicemailModal = document.getElementById('voicemailModal');
      const voicemailPreview = document.getElementById('voicemailPreview');
      const startVoicemailRecord = document.getElementById('startVoicemailRecord');
      const stopVoicemailRecord = document.getElementById('stopVoicemailRecord');
      const sendVoicemail = document.getElementById('sendVoicemail');
      let voicemailStream = null;
      let voicemailRecorder = null;
      let voicemailChunks = [];

      if (recordVoicemailBtn) {
        recordVoicemailBtn.onclick = function() {
          voicemailModal.style.display = 'block';
          startVoicemailRecord.style.display = '';
          stopVoicemailRecord.style.display = 'none';
          sendVoicemail.style.display = 'none';
          voicemailPreview.controls = false;
          voicemailPreview.src = '';
          navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {
            voicemailStream = stream;
            voicemailPreview.srcObject = stream;
            voicemailPreview.style.display = 'block';
          }).catch(err => {
            alert('Could not access camera/mic: ' + err);
          });
        };
      }
      if (startVoicemailRecord) {
        startVoicemailRecord.onclick = function() {
          voicemailChunks = [];
          voicemailRecorder = new MediaRecorder(voicemailStream);
          voicemailRecorder.ondataavailable = e => voicemailChunks.push(e.data);
          voicemailRecorder.onstop = function() {
            const blob = new Blob(voicemailChunks, { type: 'video/webm' });
            voicemailPreview.srcObject = null;
            voicemailPreview.src = URL.createObjectURL(blob);
            voicemailPreview.controls = true;
            sendVoicemail.style.display = '';
          };
          voicemailRecorder.start();
          startVoicemailRecord.style.display = 'none';
          stopVoicemailRecord.style.display = '';
        };
      }
      if (stopVoicemailRecord) {
        stopVoicemailRecord.onclick = function() {
          if (voicemailRecorder && voicemailRecorder.state === 'recording') {
            voicemailRecorder.stop();
            stopVoicemailRecord.style.display = 'none';
          }
        };
      }
      if (sendVoicemail) {
        sendVoicemail.onclick = async function() {
          const blob = new Blob(voicemailChunks, { type: 'video/webm' });
          const formData = new FormData();
          formData.append('video', blob, 'video-message.webm');
          sendVoicemail.disabled = true;
          sendVoicemail.textContent = 'Uploading...';
          try {
            const response = await fetch('http://localhost:3000/upload', {
              method: 'POST',
              body: formData
            });
            if (!response.ok) throw new Error('Upload failed');
            sendVoicemail.textContent = 'Sent!';
            alert('Your video message has been sent!');
            closeVoicemailModal();
          } catch (err) {
            alert('Failed to send video message. Please try again.');
            sendVoicemail.disabled = false;
            sendVoicemail.textContent = 'Send Video';
          }
        };
      }
      window.closeVoicemailModal = function() {
        voicemailModal.style.display = 'none';
        if (voicemailStream) {
          voicemailStream.getTracks().forEach(track => track.stop());
          voicemailStream = null;
        }
        voicemailPreview.srcObject = null;
        voicemailPreview.src = '';
        voicemailPreview.controls = false;
        if (startVoicemailRecord) startVoicemailRecord.style.display = '';
        if (stopVoicemailRecord) stopVoicemailRecord.style.display = 'none';
        if (sendVoicemail) sendVoicemail.style.display = 'none';
      };

      const imageModal = document.getElementById('imageModal');
      const imageInput = document.getElementById('imageInput');
      const imagePreview = document.getElementById('imagePreview');
      const imageSendMsg = document.getElementById('imageSendMsg');
      const openImageModalBtn = document.getElementById('openImageModal');
      if (openImageModalBtn) {
        openImageModalBtn.onclick = function() {
          imageModal.style.display = 'block';
          imagePreview.style.display = 'none';
          imageInput.value = '';
          imageSendMsg.style.display = 'none';
        };
      }
      if (imageInput) {
        imageInput.onchange = function(e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function(ev) {
              imagePreview.src = ev.target.result;
              imagePreview.style.display = 'block';
              imageSendMsg.style.display = '';
            };
            reader.readAsDataURL(file);
          }
        };
      }
      if (imageSendMsg) {
        imageSendMsg.onclick = async function() {
          const file = imageInput.files[0];
          if (!file) return;
          imageSendMsg.disabled = true;
          imageSendMsg.textContent = 'Uploading...';
          const formData = new FormData();
          formData.append('image', file);
          try {
            // You need to implement /upload-image endpoint in your backend
            const response = await fetch('http://localhost:3000/upload-image', {
              method: 'POST',
              body: formData
            });
            if (!response.ok) throw new Error('Upload failed');
            imageSendMsg.textContent = 'Sent!';
            alert('Your image has been sent!');
            closeImageModal();
          } catch (err) {
            alert('Failed to send image. Please try again.');
            imageSendMsg.disabled = false;
            imageSendMsg.textContent = 'Send Image';
          }
        };
      }
      function closeImageModal() {
        imageModal.style.display = 'none';
        imagePreview.src = '';
        imagePreview.style.display = 'none';
        imageSendMsg.style.display = 'none';
        imageSendMsg.disabled = false;
        imageSendMsg.textContent = 'Send Image';
      }
      window.closeImageModal = closeImageModal;

      // --- Contact Selection Modal Logic ---
      const contactOptions = [
        { label: 'Phone Repair', phone: '+254705926066', whatsapp: '+254705926066' },
        { label: 'Laptop Repair', phone: '+254786102736', whatsapp: '+254786102736' },
        { label: 'Key & Watch Repair', phone: '+254705222640', whatsapp: '+254705222640' },
        { label: 'Printer Repair', phone: '+254725016032', whatsapp: '+254725016032' }
      ];
      const contactSelectModal = document.getElementById('contactSelectModal');
      const contactSelectTitle = document.getElementById('contactSelectTitle');
      const contactSelectList = document.getElementById('contactSelectList');
      function showContactSelectModal(type) {
        contactSelectTitle.textContent = type === 'call' ? 'Call Which Department?' : 'WhatsApp Which Department?';
        contactSelectList.innerHTML = '';
        contactOptions.forEach(opt => {
          const btn = document.createElement('button');
          btn.className = 'hud-modal-btn';
          btn.style.margin = '8px 0';
          btn.textContent = opt.label + (type === 'call' ? ` (${opt.phone})` : '');
          btn.onclick = function() {
            if (type === 'call') {
              window.location.href = `tel:${opt.phone}`;
            } else if (type === 'whatsapp') {
              window.open(`https://wa.me/${opt.whatsapp.replace('+','')}`,'_blank');
            }
            closeContactSelectModal();
          };
          contactSelectList.appendChild(btn);
        });
        contactSelectModal.style.display = 'block';
      }
      function closeContactSelectModal() {
        contactSelectModal.style.display = 'none';
      }
      window.closeContactSelectModal = closeContactSelectModal;
      // --- Override Call/WhatsApp Buttons ---
      document.querySelectorAll('.contact-modern-btn.call').forEach(btn => {
        btn.onclick = function(e) {
          e.preventDefault();
          showContactSelectModal('call');
        };
      });
      document.querySelectorAll('.contact-modern-btn.whatsapp').forEach(btn => {
        btn.onclick = function(e) {
          e.preventDefault();
          showContactSelectModal('whatsapp');
        };
      });

      // Service details data
      const serviceDetails = {
        'Phone Repair': {
          icon: 'üì±',
          description: 'We fix all major phone brands: screens, batteries, charging ports, cameras, software, unlocking, and more. Fast, expert service with genuine parts.',
          features: [
            'Screen replacement',
            'Charging port repair',
            'Battery replacement',
            'Camera repair',
            'Software updates',
            'Unlocking & flashing',
            'Free diagnosis for most issues'
          ],
          contact: {
            phone: '+254705926066',
            whatsapp: '+254705926066',
            email: 'remaycomputersolutions@gmail.com'
          }
        },
        'Laptop Repair': {
          icon: 'üíª',
          description: 'All brands and models supported. We handle screens, keyboards, motherboards, OS installs, RAM/SSD upgrades, and more.',
          features: [
            'Screen replacement',
            'Keyboard repair',
            'Motherboard diagnostics',
            'OS installation',
            'RAM & SSD upgrades',
            'Virus removal',
            'Data recovery'
          ],
          contact: {
            phone: '+254786102736',
            whatsapp: '+254786102736',
            email: 'remaycomputersolutions@gmail.com'
          }
        },
        'Key & Watch Repair': {
          icon: '‚åöüîë',
          description: 'Key duplication, extraction, watch battery/strap, wall clock repair, and more. Fast and reliable.',
          features: [
            'Key duplication',
            'Broken key extraction',
            'Watch battery/strap',
            'Wall clock repair',
            'Quick turnaround'
          ],
          contact: {
            phone: '+254705222640',
            whatsapp: '+254705222640',
            email: 'remaycomputersolutions@gmail.com'
          }
        },
        'Printer Repair': {
          icon: 'üñ®',
          description: 'Diagnostics, cartridge/toner, print head cleaning, software, and network setup. All major brands.',
          features: [
            'Diagnostics',
            'Cartridge/toner replacement',
            'Print head cleaning',
            'Software install',
            'Network setup',
            'On-site support available'
          ],
          contact: {
            phone: '+254725016032',
            whatsapp: '+254725016032',
            email: 'remaycomputersolutions@gmail.com'
          }
        },
        'Accessories': {
          icon: 'üéßüñ±',
          description: 'Chargers, cables, power banks, cases, bags, headphones, and more. Quality tech accessories for all devices.',
          features: [
            'Chargers',
            'Cables',
            'Power banks',
            'Cases & bags',
            'Headphones',
            'Adapters',
            'And more...'
          ],
          contact: {
            phone: '+254725016032',
            whatsapp: '+254725016032',
            email: 'remaycomputersolutions@gmail.com'
          }
        },
        'Our Location': {
          icon: 'üìç',
          description: 'Visit us at Tana House Building, 1st Floor, Room 113, Karen Shopping Centre, Nairobi.',
          features: [
            'Easy access',
            'Ample parking',
            'Friendly staff',
            'Open Mon-Sat 8am-6pm'
          ],
          contact: {
            phone: '+254725016032',
            whatsapp: '+254725016032',
            email: 'remaycomputersolutions@gmail.com'
          }
        }
      };
      function showHudPopup(service) {
        const details = serviceDetails[service.title] || {};
        let html = `<div style='text-align:center;font-size:2.2em;'>${details.icon || ''}</div>`;
        html += `<h2 style='margin:8px 0 4px 0;'>${service.title}</h2>`;
        html += `<div style='margin-bottom:10px;color:#00aaff;'>${details.description || ''}</div>`;
        if (details.features && details.features.length) {
          html += '<ul style="text-align:left;margin-bottom:10px;">';
          details.features.forEach(f => html += `<li>${f}</li>`);
          html += '</ul>';
        }
        if (details.contact) {
          html += `<div style='margin-top:12px;'>
            <a href='tel:${details.contact.phone}' class='contact-modern-btn call' style='margin-right:8px;'>Call</a>
            <a href='https://wa.me/${details.contact.whatsapp.replace('+','')}' class='contact-modern-btn whatsapp' style='margin-right:8px;' target='_blank'>WhatsApp</a>
            <a href='mailto:${details.contact.email}' class='contact-modern-btn email'>Email</a>
          </div>`;
        }
        document.getElementById('serviceDetailsContent').innerHTML = html;
        document.getElementById('serviceDetailsModal').style.display = 'block';
      }
      function closeServiceDetailsModal() {
        document.getElementById('serviceDetailsModal').style.display = 'none';
      }
      window.closeServiceDetailsModal = closeServiceDetailsModal;
      // Attach to all Learn More buttons
      document.querySelectorAll('.service-btn').forEach(btn => {
        btn.onclick = function() {
          const card = btn.closest('.service-card');
          const title = card ? card.querySelector('h3').textContent.trim() : btn.textContent.trim();
          showHudPopup({ title });
        };
      });

      // --- Disable heavy graphics on small screens for mobile performance ---
      function adjustForMobilePerformance() {
        if (window.innerWidth < 600) {
          // Hide matrix rain
          var matrixRain = document.getElementById('matrixRain');
          if (matrixRain) matrixRain.style.display = 'none';
          // Hide or reduce animated backgrounds
          var glassBg = document.querySelector('.glass-bg');
          if (glassBg) glassBg.style.display = 'none';
          var infinityRgb = document.querySelector('.infinity-rgb');
          if (infinityRgb) infinityRgb.style.display = 'none';
        } else {
          // Show them on desktop
          var matrixRain = document.getElementById('matrixRain');
          if (matrixRain) matrixRain.style.display = '';
          var glassBg = document.querySelector('.glass-bg');
          if (glassBg) glassBg.style.display = '';
          var infinityRgb = document.querySelector('.infinity-rgb');
          if (infinityRgb) infinityRgb.style.display = '';
        }
      }
      window.addEventListener('resize', adjustForMobilePerformance);
      adjustForMobilePerformance();
    });
  </script>

  <!-- Force all video elements to never be mirrored, even if JS or inline style tries to mirror them -->
  <script>
    setInterval(() => {
      document.querySelectorAll('video').forEach(v => {
        v.style.transform = 'none';
        v.style.webkitTransform = 'none';
      });
    }, 500);
  </script>

  <!-- Modern Footer -->
  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-section business-info">
        <div class="footer-logo">REMAY COMPUTER Solutions</div>
        <div class="footer-copyright">¬© 2020 REMAY COMPUTER Solutions. All rights reserved.</div>
      </div>
      <div class="footer-section contact-info">
        <div><span class="footer-icon">üìß</span> <a href="mailto:remaycomputersolutions@gmail.com">remaycomputersolutions@gmail.com</a></div>
        <div><span class="footer-icon">üìû</span> 
          <a href="tel:+254725016032">0725 016 032</a> |
          <a href="tel:+254705222640">0705 222 640</a> |
          <a href="tel:+254786102736">0786 102 736</a> |
          <a href="tel:+254705926066">0705 926 066</a>
        </div>
      </div>
      <div class="footer-section address-info">
        <div><span class="footer-icon">üìç</span> <strong>Address:</strong></div>
        <div>Tana House Building, 1st Floor, Room 113</div>
        <div>Karen Shopping Centre, Next to Crossroads Mall</div>
        <div>Langata Road, Nairobi, Kenya</div>
        <div>Postal Code: 00502</div>
      </div>
      <div class="footer-section quick-links">
        <div><strong>Quick Links:</strong></div>
        <nav class="footer-nav">
          <a href="#">Home</a> |
          <a href="#about">About Us</a> |
          <a href="#services">Services</a> |
          <a href="#contact">Contact Us</a> |
          <a href="#support">Support</a> |
          <a href="#privacy">Privacy Policy</a> |
          <a href="#terms">Terms of Service</a>
        </nav>
      </div>
    </div>
  </footer>
</body>
</html>